!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).PouchUpsert=e()}}(function(){return function o(u,f,d){function c(t,e){if(!f[t]){if(!u[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(s)return s(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var i=f[t]={exports:{}};u[t][0].call(i.exports,function(e){return c(u[t][1][e]||e)},i,i.exports,o,u,f,d)}return f[t].exports}for(var s="function"==typeof require&&require,e=0;e<d.length;e++)c(d[e]);return c}({1:[function(e,t,n){"use strict";function c(u,f,d){return"string"!=typeof f?Promise.reject(new Error("doc id is required")):u.get(f).catch(function(e){if(404!==e.status)throw e;return{}}).then(function(e){var t,n,r,i=e._rev,o=d(e);return o?(o._id=f,o._rev=i,n=o,r=d,(t=u).put(n).then(function(e){return{updated:!0,rev:e.rev,id:n._id}},function(e){if(409!==e.status)throw e;return c(t,n._id,r)})):{updated:!1,rev:i,id:f}})}n.__esModule=!0;n.upsert=function(e,t,n){var r=c(this,e,t);if("function"!=typeof n)return r;r.then(function(e){n(null,e)},n)};n.putIfNotExists=function(e,t,n){"string"!=typeof e&&(n=t,e=(t=e)._id);var r=c(this,e,function(e){return!e._rev&&t});if("function"!=typeof n)return r;r.then(function(e){n(null,e)},n)}},{}]},{},[1])(1)});
